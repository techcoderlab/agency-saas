{
    "openapi": "3.0.0",
    "info": {
      "title": "Agency SaaS API",
      "version": "1.0.0",
      "description": "API documentation for Agency SaaS, including Leads, Forms, and Webhooks modules."
    },
    "servers": [
      {
        "url": "http://localhost:8000/api",
        "description": "Local Development Server"
      }
    ],
    "components": {
      "securitySchemes": {
        "bearerAuth": {
          "type": "http",
          "scheme": "bearer",
          "bearerFormat": "JWT"
        }
      }
    },
    "paths": {
      "/login": {
        "post": {
          "tags": ["Authentication"],
          "summary": "Login User",
          "requestBody": {
            "required": true,
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "email": { "type": "string", "example": "admin@agency.com" },
                    "password": { "type": "string", "example": "password" }
                  }
                }
              }
            }
          },
          "responses": {
            "200": {
              "description": "Successful login",
              "content": {
                "application/json": {
                  "schema": {
                    "type": "object",
                    "properties": {
                      "token": { "type": "string" }
                    }
                  }
                }
              }
            }
          }
        }
      },
      "/leads": {
        "get": {
          "tags": ["Leads"],
          "summary": "List Leads",
          "security": [{ "bearerAuth": [] }],
          "parameters": [
            { "name": "page", "in": "query", "schema": { "type": "integer" } },
            { "name": "status", "in": "query", "schema": { "type": "string" } },
            { "name": "search", "in": "query", "schema": { "type": "string" } }
          ],
          "responses": {
            "200": { "description": "Paginated list of leads" }
          }
        }
      },
      "/leads/{id}": {
        "get": {
          "tags": ["Leads"],
          "summary": "Get Lead Details",
          "security": [{ "bearerAuth": [] }],
          "parameters": [
            { "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }
          ],
          "responses": {
            "200": { "description": "Lead details with activities" }
          }
        },
        "put": {
          "tags": ["Leads"],
          "summary": "Update Lead",
          "security": [{ "bearerAuth": [] }],
          "parameters": [
            { "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }
          ],
          "requestBody": {
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": { "type": "string" },
                    "temperature": { "type": "string" }
                  }
                }
              }
            }
          },
          "responses": {
            "200": { "description": "Updated lead" }
          }
        }
      },
      "/leads/{id}/note": {
        "post": {
          "tags": ["Leads"],
          "summary": "Add Activity Note",
          "security": [{ "bearerAuth": [] }],
          "parameters": [
            { "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }
          ],
          "requestBody": {
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "content": { "type": "string" }
                  }
                }
              }
            }
          },
          "responses": {
            "201": { "description": "Note added" }
          }
        }
      },
      "/forms": {
        "get": {
          "tags": ["Forms"],
          "summary": "List Forms",
          "security": [{ "bearerAuth": [] }],
          "responses": {
            "200": { "description": "List of forms" }
          }
        },
        "post": {
          "tags": ["Forms"],
          "summary": "Create Form",
          "security": [{ "bearerAuth": [] }],
          "requestBody": {
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "name": { "type": "string" },
                    "schema": { "type": "array", "items": { "type": "object" } },
                    "webhook_url": { "type": "string" }
                  }
                }
              }
            }
          },
          "responses": {
            "201": { "description": "Form created" }
          }
        }
      },
      "/webhooks": {
        "get": {
          "tags": ["Webhooks"],
          "summary": "List Webhooks",
          "security": [{ "bearerAuth": [] }],
          "responses": {
            "200": { "description": "List of webhooks" }
          }
        },
        "post": {
          "tags": ["Webhooks"],
          "summary": "Create Webhook",
          "security": [{ "bearerAuth": [] }],
          "requestBody": {
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "name": { "type": "string" },
                    "url": { "type": "string" },
                    "events": { "type": "array", "items": { "type": "string" } }
                  }
                }
              }
            }
          },
          "responses": {
            "201": { "description": "Webhook registered" }
          }
        }
      },
      "/admin/stats": {
          "get": {
              "tags": ["Admin"],
              "summary": "Dashboard Stats",
              "security": [{ "bearerAuth": [] }],
              "responses": {
                  "200": { "description": "Stats and Config" }
              }
          }
      },
      "/public/form/{id}": {
          "get": {
              "tags": ["Public"],
              "summary": "Get Public Form Schema",
              "parameters": [
                  { "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }
              ],
              "responses": {
                  "200": { "description": "Form Definition" }
              }
          }
      },
      "/public/submit/{id}": {
          "post": {
              "tags": ["Public"],
              "summary": "Submit Public Form",
              "parameters": [
                  { "name": "id", "in": "path", "required": true, "schema": { "type": "string" } }
              ],
              "requestBody": {
                  "content": {
                      "application/json": {
                          "schema": { "type": "object", "additionalProperties": true }
                      }
                  }
              },
              "responses": {
                  "200": { "description": "Submission Successful" }
              }
          }
      }
    }
  }